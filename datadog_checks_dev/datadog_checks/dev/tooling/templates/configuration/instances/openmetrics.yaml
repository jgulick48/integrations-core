- name: openmetrics_endpoint
  required: true
  description: The URL exposing metrics in the OpenMetrics format.
  value:
    type: string
- name: namespace
  required: false
  hidden: true
  description: The namespace to be prepended to all metrics.
  value:
    type: string
- name: metrics
  required: false
  hidden: true
  description: |
    This list defines which metrics to collect from the `openmetrics_endpoint`.
    Metrics may be defined in 3 ways:

    1. If the item is a string, then it represents the exposed metric name, and
       the sent metric name will be identical. For example:

         - metrics:
           - <METRIC_1>
           - <METRIC_2>
    2. If the item is a mapping, then the keys represent the exposed metric names.

         a. If a value is a string, then it represents the sent metric name. For example:

              - metrics:
                - <EXPOSED_METRIC_1>: <SENT_METRIC_1>
                - <EXPOSED_METRIC_2>: <SENT_METRIC_2>
         b. If a value is a mapping, then it must have a `name` and/or `type` key.
            The `name` represents the sent metric name, and the `type` represents how
            the metric should be handled, overriding any type information the endpoint
            may give. For example:

              - metrics:
                - <EXPOSED_METRIC_1>:
                    name: <SENT_METRIC_1>
                    type: <METRIC_TYPE_1>
                - <EXPOSED_METRIC_2>:
                    name: <SENT_METRIC_2>
                    type: <METRIC_TYPE_2>

    Regular expressions may be used to match the exposed metric names, for example:

      - metrics:
        - network_(ingress|egress)_.+
        - .+:
            type: gauge
  value:
    type: array
    items:
      oneOf:
      - type: string
      - type: object
        additionalProperties:
          oneOf:
          - type: string
          - type: object
            properties:
              name:
                type: string
              type:
                type: string
            additionalProperties: true
- template: instances/http
- template: instances/default
